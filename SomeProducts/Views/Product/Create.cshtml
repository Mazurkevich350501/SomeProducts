
@model SomeProducts.Models.ProductModels.ProductViewModel

@{
    bool isEdit = Model.Product.ProductId != 0;
    var title = isEdit ? "Edit" : "Create";
    ViewBag.Title = title;
}

<h2>@title</h2>

<form method="post" action=@Url.Action(isEdit ? "Edit" : "Create", "Product") enctype="multipart/form-data">
    @Html.HiddenFor(m => m.Product.ProductId)
    @Html.HiddenFor(m => m.Product.CreateDate)
    @Html.HiddenFor(m => m.Product.ModifiedDate)
    @Html.HiddenFor(m => m.Product.Image)
    @Html.HiddenFor(m => m.Product.ImageType)
    <div class="row">
        <div class="col-lg-8">
            @Html.ValidationMessageFor(m => m.Product.Name, "", new { id = (@Html.IdFor(m => m.Product.Name) + "_Validation") })
            <div class="row">
                <h4 class="col-lg-3">Product Name*</h4>
                @Html.TextBoxFor(m => m.Product.Name, new { @class = "form-control col-lg-5" })
            </div>
            @Html.ValidationMessageFor(m => m.Product.Description, "", new { id = (@Html.IdFor(m => m.Product.Description) + "_Validation") })
            <div class="row description-text-area">
                <h4 class="col-lg-3">Description</h4>
                @Html.TextAreaFor(m => m.Product.Description, new { @class = "form-control col-lg-5"})
            </div>
            @Html.ValidationMessageFor(m => m.Product.BrandId, "", new { id = (@Html.IdFor(m => m.Product.BrandId) + "_Validation") })
            <div class="row">
                <h4 class="col-lg-3">Brand*</h4>
                @Html.DropDownListFor(m => m.Product.BrandId, new SelectList(Model.Brands, "Key", "Value", Model.Product.BrandId), new { @class= "btn col-lg-5 btn-default dropdown-toggle" })            
                <button type="button" id="brandEditBtn" class="btn btn-info buttun-left-margin" data-toggle="modal" data-target="#BrandModal">Edit</button>
            </div>
            @Html.ValidationMessageFor(m => m.Product.Color, "", new { id = (@Html.IdFor(m => m.Product.Color) + "_Validation") })
            <div class="row">
                <h4 class="col-lg-3">Color</h4>
                @Html.DropDownListFor(m => m.Product.Color, new SelectList(Model.Colors, "Key", "Value", Model.Product.Color))
            </div>
            @Html.ValidationMessageFor(m => m.Product.Quantity, "", new { id = (@Html.IdFor(m => m.Product.Quantity) + "_Validation") })
            <div class="row">
                <h4 class="col-lg-3">Quantity</h4>
                @Html.TextBoxFor(m => m.Product.Quantity, new { @class = "form-control col-lg-5" })
            </div>
        </div>
        <div class="col-lg-4">
            <img class="image-box" id="image" />
        <div>
            <input type="file" name="file" id="file" />
        </div>
        </div>
    </div>
    <div>
        <input type="submit" class="btn btn-success" value=@(isEdit ? "Save" : "Create") onclick="addDateToForm()"/>
        @if (isEdit)
        {
            <div id="delete-btn" class="btn btn-warning" onclick="deleteProduct()">Delete</div>
        }
    </div> 
</form>
    
<div id="BrandModal" class="modal fade" role="dialog">
    <div class="modal-dialog" id="modal_dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title">Brands</h4>
            </div>
            <div class="modal-body" id="modal-body">
                <div>
                    <div class="row">
                        <p class="field-validation-error" id="newBrandValidation"></p>
                        <input class="new-brand-input form-control col-lg-10" id="newBrandName" />
                        <button class="btn btn-success glyphicon glyphicon-plus-sign buttun-left-margin" onclick="addNewBrand()"></button>
                    </div>
                </div>   
            </div>
            <div class="modal-footer">
                <button class="btn btn-success" onclick="saveBrandsChanges()">Save</button>
            </div>
        </div>
    </div>
</div>

@section scripts
{
<script>
    var isEdit = "@isEdit" === true;
    var createDateId = '@Html.IdFor(m => m.Product.CreateDate)';
    var modifiedDateId = '@Html.IdFor(m => m.Product.ModifiedDate)';
    var colorpickerId = '@Html.IdFor(m => m.Product.Color)';
    var brandDropdownId = '@Html.IdFor(m => m.Product.BrandId)';
    var imageDataId = '@Html.IdFor(m => m.Product.Image)';
    var imageTypeId = '@Html.IdFor(m => m.Product.ImageType)';
    var quantityId = '@Html.IdFor(m => m.Product.Quantity)';
    var productId = '@Html.IdFor(m => m.Product.ProductId)';
    var deleteProductUrl = '@Url.Action("Delete", "Product")';
    var getImageUrl = '@Url.Action("GetImage", "Product")';
    var getBrandsListUrl = '@Url.Action("GetBrandsList", "Product")';
    var isBrandUsingUrl = '@Url.Action("IsBrandUsing", "Product")';
    var saveBrandsChangesUrl = '@Url.Action("SaveBrandsChanges", "Product")';
</script>

<script src="~/bower_components/jquery-simplecolorpicker/jquery.simplecolorpicker.js"></script>
<script src="~/Scripts/ModalView/ModalView.js"></script>
<script src="~/Scripts/Product/ProductModalWindowControl.js"></script>    
<script src="~/Scripts/Product/ProductColorpicker.js"></script>
<script src="~/Scripts/Product/ProductImageController.js"></script>
<script src="~/Scripts/Product/ProductControl.js"></script>
}

@section stylesheets
{
    <link rel="stylesheet" href="~/bower_components/jquery-simplecolorpicker/jquery.simplecolorpicker.css">
    <link rel="stylesheet" href="~/Scripts/ModalView/ModalView.css" />
    <link rel="stylesheet" href="~/Scripts/Product/Product.css" />
}